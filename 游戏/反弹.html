<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script>
        function getstyle(obj,attr) {
            if(obj.currentStyle){
                return obj.currentStyle[attr];
            }else{
                return getComputedStyle(obj,false)[attr];
            }
        }
        function startmove(obj,json,fn) {
            clearInterval(obj.timer);
            obj.timer = setInterval(function () {
                var bstop=true;
                for(var attr in json){
                    var icur =0;
                    if(attr=="opacity"){
                        icur=parseInt(parseFloat(getstyle(obj,attr))*100);
                    }else{
                        icur=parseInt(getstyle(obj,attr));
                    }
                    var iSpeed = (json[attr] - icur) / 6;
                    iSpeed = iSpeed > 0 ? Math.ceil(iSpeed) : Math.floor(iSpeed);
                    if (icur != json[attr]) {
                        bstop=false;
                    }
                    if(attr=="opacity"){
                        obj.style.filter='alpha(opacity:'+(icur+iSpeed)+')';
                        obj.style.opacity=(icur+iSpeed)/100;
                    }else{
                        obj.style[attr]= icur + iSpeed+"px";
                    }
                }
                if(bstop)
                {
                    clearInterval(obj.timer);
                    if(fn)
                    {
                        fn();
                    }
                }
            }, 30)
        }
        window.onload=function () {
            var loo=document.getElementById("look");
            var st=document.getElementById("start");
            var dan=document.getElementById("div1");
            var box=document.getElementById("box");
            var ms=document.getElementById("ms");
            var ma=document.getElementById("ma");
            var bl=box.offsetLeft,bt=box.offsetTop;
            var bw=box.offsetWidth,bh=box.offsetHeight;
            var lw=loo.offsetWidth,l=0;
            var pt=0;var l2=0;
            var clai=document.getElementById("clai");
            var toai=document.getElementById("toai");var ai=0;
            st.onclick=function(){
                startmove(toai,{opacity:0},function () {
                    toai.style.display="none";
                });
                startmove(clai,{opacity:0},function () {
                    toai.style.display="none";
                });
                startmove(st,{opacity:0},function () {
                    st.style.display="none";
                    var ran=Math.floor(Math.random()*1000+100);
                    dan.style.left=ran+"px";
                    dan.style.top=25+"px";
                    startmove(dan,{opacity:100});
                    startmove(loo,{opacity:100});
                    stmove();
                });
                if(ai==1){
                    startmove(ma,{opacity:100});
                }
            };
            toai.onclick=function(){
              ai=1;ms.innerHTML="自动开启";
                startmove(ms,{opacity:100});
            };
            clai.onclick=function(){
               ai=0;ms.innerHTML="自动关闭";
               startmove(ms,{opacity:0});
            };
            ma.onclick=function(){
                ai=0;startmove(ma,{opacity:0});startmove(ms,{opacity:0});
            };
            document.onmousemove=function(e){
                if(ai==0){
                    var ev=e||event;
                    l=ev.clientX-50;
                    if(l<=bl){
                        l=bl;
                    }else if(l>=bl+bw-lw){
                        l=bl+bw-lw;
                    }
                    loo.style.left=l+"px";
                }
            };
            var sx=10,sy=10,timer=null;
            function stmove() {
                clearInterval(timer);
                timer=setInterval(function () {
                     l2=dan.offsetLeft+sx;var t=dan.offsetTop+sy;
                    var dw=dan.offsetWidth,dh=dan.offsetHeight;
                    if(l2<=bl){
                        l2=bl;sx*=-1;
                    }else if(l2>=bl+bw-dw){
                        l2=bl+bw-dw;sx*=-1;
                    }
                    if(ai==1){
                        l=l2-50;
                        if(l<=bl){
                            l=bl;
                        }else if(l>=bl+bw-lw){
                            l=bl+bw-lw;
                        }
                        loo.style.left=l+"px";
                    }
                    if(t<=bt){
                        t=bt;sy*=-1;
                    }else if(t>=bt+bh-dh){
                        if(l2>=l&&l2<=l+lw){
                            t=bt+bh-dh;sy*=-1;pt+=1;
                        }else{
                            alert("You got "+pt+" points!");
                            clearInterval(timer);
                            startmove(dan,{opacity:0});
                            sx=10;sy=10;pt=0;
                            startmove(toai,{opacity:100},function () {
                                toai.style.display="block";
                            });
                            startmove(clai,{opacity:100},function () {
                                clai.style.display="block";
                            });
                            startmove(st,{opacity:100},function () {
                                st.style.display="block";
                            });
                        }
                    }
                    if(pt==2){
                        if(sx>0){
                            sx=13;
                        }else if(sx<0){
                            sx=-13;
                        }
                        if(sy>0){
                            sy=15;
                        }else if(sy<0){
                            sy=-15;
                        }
                    }else if(pt==6){
                        if(sx>0){
                            sx=16;
                        }else if(sx<0){
                            sx=-16;
                        }
                        if(sy>0){
                            sy=19;
                        }else if(sy<0){
                            sy=-19;
                        }
                    }else if(pt==15){
                        if(sx>0){
                            sx=26;
                        }else if(sx<0){
                            sx=-26;
                        }
                        if(sy>0){
                            sy=33;
                        }else if(sy<0){
                            sy=-33;
                        }
                    }
                    dan.style.left=l2+"px";
                    dan.style.top=t+"px";
                },20);
            }
        }
    </script>
    <style>
        *{
            margin: 0;padding: 0;
        }
        #box{
            width: 1300px;height: 700px;position: absolute;
            border: 1px solid black;left: 50px;top: 10px;
        }
        #div1{
            width: 15px;height: 15px;border: 1px solid black;background-color: gold;position: absolute;
            border-radius: 10em;
             top: 25px;left:225px ;filter:alpha(opacity:0);opacity:0;
        }
        #look{
            width: 150px;height: 10px;background-color: black;position: absolute;
            top: 702px;left: 700px;filter:alpha(opacity:0);opacity:0;
        }
        #start,#toai,#clai{
            width: 100px;height: 30px;text-align: center;line-height: 30px;
            margin: 15px auto;display: block;text-decoration: none;color: blue;
            border-bottom: 1px solid silver;position: relative;top: 200px;
        }
        #ms{
            position: relative;top: -145px;
        }
        #ma{
            position: absolute;top:35px;left: 55px;filter:alpha(opacity:0);opacity:0;
        }
    </style>
</head>
<body>
<div id="box">
    <a id="start" href="#">开始游戏</a>
    <a id="toai" href="#">自动</a>
    <a id="clai" href="#">关闭自动</a>
    <div id="ms"></div>

</div>
<div id="look"></div>
<div id="div1"></div>
<div id="ma">关闭自动</div>
</body>
</html>